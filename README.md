# Projeto Android - App de Banco | T26 CIn/Motorola
1. Para implementar a funcionalidade que atualiza a lista de contas automaticamente na tela com o LiveData<List<Conta>> no ContaViewModel, o Adapter do RecyclerView precisou ser notificado sempre que os dados mudarem.
2. Para implementar a mudança da imagem no ImageView de acordo com o saldo da conta, a função bindTo verifica se o saldo é negativo e altera o recurso de imagem do ImageView.
3. Para implementar a funcionalidade dos botões de editar conta, o número da conta é passado através do Intent da EditarContaActivity, que pode usar o número para carregar os dados da conta e permitir a edição. Para remover a conta, o código chama o método de remoção que utiliza a anotação @Delete na Room.
4. Para garantir que o Intent criado na ContaViewHolder inclua o número da conta, foi necessário ajustar o código do OnClickListener do botão de edição. Esse número é essencial para recuperar os dados da conta na EditarContaActivity. Na EditarContaActivity, o código recupera o número da conta do Intent e utiliza para buscar os dados corretos no banco de dados.
5. Para validar das informações digitadas e o salvamento do objeto Conta no banco de dados usando ContaViewModel, o código implementa validações para os Campos de Entrada, Verificando se todos os campos foram preenchidos, se o saldo é um número válido, o nome tem pelo menos 5 caracteres e se o CPF é válido. O código usa o ContaViewModel para inserir a conta no banco de dados, caso todas as validações sejam bem-sucedidas.
6. Para atualizar uma conta, o código usa a anotação @Update do Room para atualizar uma entrada existente no banco de dados. O método atualizar(Conta c) vai atualizar a conta que já existe no banco de dados; remove uma conta com @Delete para deletar uma entrada do banco de dados. O método remover(Conta c) vai remover a conta correspondente; busca conta pelo número com @Query("SELECT * FROM contas WHERE numero = :numeroConta LIMIT 1") seleciona uma conta específica com base no número da conta (numeroConta). O LIMIT 1 garante que apenas uma conta seja retornada (caso existam múltiplas com o mesmo número, o que não deveria acontecer); busca contas pelo nome do cliente com @Query("SELECT * FROM contas WHERE nomeCliente LIKE :nomeCliente"), que busca todas as contas que correspondem ao nome do cliente. O LIKE permite realizar buscas parciais, por exemplo, se o usuário digitar "João", ele pode encontrar "João Silva", "João Pedro", etc. Para buscar Conta pelo CPF a anotação @Query("SELECT * FROM contas WHERE cpf = :cpfCliente LIMIT 1") seleciona uma conta específica com base no CPF do cliente (cpfCliente). O LIMIT 1 é usado para garantir que apenas uma conta seja retornada.
7. Para atualizar a conta, o método atualizar(Conta c) usa o método atualizar da interface ContaDAO para atualizar uma conta existente no banco de dados. Para remover uma conta o método remover(Conta c) usa o método remover da interface ContaDAO para deletar uma conta do banco de dados. Buscar conta pelo nome do cliente com o método buscarPeloNome(String nomeCliente) utiliza o método buscarPeloNome da interface ContaDAO para buscar e retornar uma lista de contas que correspondem ao nome do cliente fornecido. O método buscarPeloCPF(String cpfCliente) usa o método buscarPeloCPF da interface ContaDAO para buscar e retornar uma lista de contas que correspondem ao CPF do cliente fornecido. O método buscarPeloNumero(String numeroConta) utiliza o método buscarPeloNumero da interface ContaDAO para buscar e retornar a conta que corresponde ao número da conta fornecido. A anotação @WorkerThread indica que esses métodos devem ser chamados em uma thread de trabalho (background), fora da thread principal, para evitar bloqueios na interface do usuário. A responsabilidade de garantir que esses métodos sejam chamados na thread correta recai sobre a camada que usa essa classe.
8. O método atualizar(Conta c) chama o método correspondente atualizar do ContaRepository para atualizar a conta no banco de dados. Esse processo é executado em uma thread separada usando new Thread(...). O método remover(Conta c) chama o método remover do ContaRepository para deletar a conta do banco de dados, também em uma thread separada. O método buscarPeloNumero(String numeroConta) chama o método buscarPeloNumero do ContaRepository em uma thread separada. Quando a conta é encontrada, a _contaAtual é atualizada com o valor da conta encontrada. Isso permitirá que a UI observe a contaAtual e atualize automaticamente com os dados da conta quando a busca for concluída. O método deletarConta(Conta c) parece ser um atalho para remover(c). Todos os métodos de modificação ou busca de dados são executados em threads separadas para garantir que as operações de I/O com o banco de dados não bloqueiem a thread principal da interface do usuário. Usar LiveData permite que a interface do usuário seja reativa às mudanças nos dados, facilitando a construção de interfaces dinâmicas e responsivas.
9. O número da conta é passado para a EditarContaActivity via Intent. Esse número é usado para buscar os detalhes da conta no banco de dados utilizando o método buscarPeloNumero do ContaViewModel. A conta encontrada é observada pelo LiveData contaAtual, e quando é alterada, os campos de texto são preenchidos com os dados da conta. O botão btnAtualizar permite editar a conta. Antes de criar uma nova instância de Conta, os campos são validados usando o método validarCampos. Se os campos são válidos, a conta é atualizada no banco de dados chamando viewModel.atualizar(contaAtualizada).
O botão btnRemover permite deletar a conta. A conta é removida do banco de dados utilizando viewModel.remover(contaParaRemover), e a Activity é finalizada após a remoção.
O método validarCampos verifica se o nome tem pelo menos 5 caracteres, se o CPF tem 11 dígitos, e se o saldo é um número válido. Se qualquer uma dessas validações falhar, o método retorna false e exibe um erro no campo correspondente. Após a atualização ou remoção da conta, a Activity é finalizada, retornando à tela anterior.
10. Ação transferir recupera as contas de origem e destino usando o ContaRepository; verifica se a conta de origem tem saldo suficiente; atualiza as contas no banco de dados após realizar a transferência; registra as transações de débito e crédito associadas à transferência.
creditar busca a conta pelo número, credita o valor e atualiza no banco de dados; Também registra uma transação de crédito.
debitar busca a conta pelo número, verifica se tem saldo suficiente, debita o valor e atualiza no banco de dados, registra uma transação de débito; buscarContaPeloNumero, buscarContasPeloNome, buscarContasPeloCPF utilizam os métodos do ContaRepository para buscar contas pelo número, nome ou CPF.
Os métodos de transações (buscarTransacoesPeloNumero, buscarTransacoesPeloTipo, buscarTransacoesPelaData) realizam a busca das transações usando o TransacaoRepository e podem ser manipuladas para exibição ou processamento posterior.
11. Para implementar a validação dos números das contas e do valor da operação nas classes DebitarActivity, CreditarActivity e TransferirActivity, o código verifica se o número da conta foi preenchido e se corresponde ao formato desejado (por exemplo, tamanho mínimo/máximo). BancoViewModel verifica se a conta realmente existe no banco de dados.
12. Para implementar a funcionalidade de busca na classe PesquisarActivity com base no tipo de busca escolhido pelo usuário no RadioGroup, o código identifica o tipo de pesquisa verificando qual opção o usuário selecionou no RadioGroup (tipoPesquisa); realizar a busca dependendo da opção selecionada, chamar o método correspondente no BancoViewModel para realizar a pesquisa; atualiza o RecyclerView exibiindo os resultados da busca no RecyclerView usando o ContaAdapter. O RadioGroup tipoPesquisa contém três RadioButton que permitem ao usuário escolher o tipo de busca. Quando o botão "Pesquisar" é clicado, ele verifica qual tipo foi selecionado usando getCheckedRadioButtonId(). A busca depende da seleção do usuário. Se for buscar pelo número da conta, viewModel.buscarContaPeloNumero(termoPesquisa); Se for pelo nome do cliente, viewModel.buscarContasPeloNome(termoPesquisa). Se for pelo CPF, viewModel.buscarContasPeloCPF(termoPesquisa).
Cada um desses métodos retorna um LiveData<List<Conta>>. o método observe() escuta mudanças no banco de dados e atualiza o RecyclerView com os resultados.
Após a busca, o resultado é atualizado no ContaAdapter usando adapter.submitList(contas). Se a lista estiver vazia, uma mensagem de erro dizendo que nenhuma conta foi encontrada aparece.
13. Para atualizar o RecyclerView em tempo real enquanto a busca está sendo realizada na PesquisarActivity, o código chama o método LiveData e observa os resultados conforme eles são atualizados no banco de dados. Esse processo garante que, assim que os dados forem encontrados, eles serão exibidos no RecyclerView sem precisar esperar a finalização de toda a busca. Algumas modificações no BancoViewModel foram feitas, como garantir que os métodos de busca no BancoViewModel retornem LiveData, para que as atualizações possam ser observadas na PesquisarActivity.
14. Para exibir o valor total de dinheiro armazenado no banco na tela principal da MainActivity, o código calcula a soma de todos os saldos das contas no banco de dados. o LiveData observa os saldos das contas e atualizar a interface automaticamente. No BancoViewModel, foi adicionado um método para calcular a soma de todos os saldos das contas. Esse método retorna um LiveData<Double> para que as mudanças e atualizar a interface em tempo real possam ser observadas. No ContaRepository, um método que retorna o valor total de dinheiro no banco foi adicionado. Na MainActivity tem o LiveData que contém o valor total de dinheiro no banco e atualiza a TextView que exibe esse valor conforme ele muda.
